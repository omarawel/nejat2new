{
  "rules": {
    "databases": {
      "database": {
        "documents": {
          // Allow public read access to ads, site content, and subscription plans
          "ads/{adId}": {
            "allow read": true,
            "allow write": false // Should be managed by admin SDK
          },
          "siteContent/{docId}": {
            "allow read": true,
            "allow write": false // Should be managed by admin SDK
          },
          "subscriptionPlans/{planId}": {
            "allow read": true,
            "allow write": false // Should be managed by admin SDK
          },
          // Allow authenticated users to read/write to hatim groups
          "hatimGroups/{groupId}": {
            "allow read": true,
            "allow write": "if request.auth != null"
          },
          // Allow admins to read contact submissions
          "contactSubmissions/{submissionId}": {
            "allow read, write": "if get(/databases/(default)/documents/users/$(request.auth.uid)).data.isAdmin == true"
          },
          // User-specific data rules
          "users/{userId}": {
            "allow read, write": "if request.auth.uid == userId",
            // Subcollections for a user
            "documents": {
              "subscriptions/{subId}": {
                "allow read, write": "if request.auth.uid == userId"
              },
              "usage/{usageId}": {
                "allow read, write": "if request.auth.uid == userId"
              },
              "favorites/{favId}": {
                "allow read, write": "if request.auth.uid == userId"
              },
              "diaryEntries/{entryId}": {
                "allow read, write": "if request.auth.uid == userId"
              },
              "config/{configId}": {
                "allow read, write": "if request.auth.uid == userId"
              },
              "admin/{adminConfigId}": {
                "allow read, write": "if request.auth.uid == userId && get(/databases/(default)/documents/users/$(request.auth.uid)).data.isAdmin == true"
              }
            }
          }
        }
      }
    }
  }
}
